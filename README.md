# Simulation of doped hexagonal Boron-Nitride using Abinit
This project uses a program called [Abinit](http://www.abinit.org/) to simulate a mono-layer boron-nitride hexagonal lattice (hBN) using ab-inito principles. The goals of this project are as follows:

- Optimize the geometry of hBN
- Determine the energy of formation of hBN
- Dope hBN with carbon by replacing boron or nitrogen in various densities
- Characterize the trend of energy of formation vs. doping density

This project was written for the laboratory of Jun Namakura (中村 淳) at the University of Electro-communications (電気通信大学) in Tokyo (東京都), Japan (日本).

## Contributing
The main point of this project is for me to do the work myself, but I'm always happy to get feedback. At present, I will not be accepting pull requests, but please feel free to submit an Issue on GitHub.

## License
See [LICENSE.md](LICENSE.md).

## Dependencies
This program uses the following programs:

- [Abinit](http://www.abinit.org/) to perform the simulation, assumed to be called `abinit`
- [python](https://www.python.org/) version 2 to execute various custom analysis scripts, assumed to the user's $PATH as `python`. These scripts can be configured in the [Makefile](Makefile), and can be found [here](https://github.com/paxromana96/abinit-research-tools).
    - `parse_band_eigenvalues.py` to convert `_EIG` files into more-easily readable [JSON](http://www.json.org/) form for analysis
    - `graph_band_eigenvalues.py` to graph the band eigenenergies output in JSON from `parse_band_eigenvalues.py` (above)
    - `generate_abinit_input_file_from_json.py` to generate Abinit input files from .abinit.json files
- [Java](https://java.com) to execute various custom analysis scripts, assumed to be in the user's $PATH as `java`
    - `spacedToCSV.jar` to convert `.dat` files output by `cut3d` into more-easily computable [CSV](https://en.wikipedia.org/wiki/Comma-separated_values). Currently I'm targeting Java 1.7.
        + Note this is not commonly used anymore, but I've kept this recipe in case it's still useful.
- [GNU Make](https://www.gnu.org/software/make/) to execute the Makefile that automatically runs the above programs. It is, of course, still possible to run this project without Make, but very tedious.

## Use
### Makefile
Most of the program has been set up to run via a [Makefile](Makefile).
#### Recipes
The following make recipes are used (note that `%` refers to a wildcard string):

- `geom` optimize the geometry of the lattice
- `band` determine the band energy eigenstates of the lattice, and graph it as .svg
- `charge` determine the charge density of the lattice, and output it as .xsf
- `%.in` to generate an input file for Abinit from a `.abinit.json` file
- `%.out` run the experiment `%.in` in Abinit and output the results to `%.out`. Errors are reported to `log`
- `%.files` generate a file with the command-line user input to `abinit` for the experiment `%.in`
- `%_band_eigen_energy.json` use the python script `parse_band_eigenvalues.py` to parse `%_EIG` and output it in more-readable `JSON` format.
- `%_band_eigen_energy.svg` use the python script `graph_band_eigenvalues.py` to parse `%_band_eigen_energy.json` and graph it
- `%_3d_indexed.dat` leverage `cut3d` from the Abinit suite to get 3d indexed data from `%_DEN`.
- `%_3d_indexed.csv` use the Java script `spacedToCSV.jar` to parse `%_3d_indexed.dat` and output it in more-readable `CSV` format
- `clean` execute `cleanLog`, `cleanTemp`, and `cleanOutput` to remove files generated by Abinit. This does not remove files generated by analysis scripts.
- `cleanTemp` remove all files with `.generic` in the file name
- `cleanLog` remove the log
- `cleanOutput` remove all files with `.out` in the file name

#### Customization
Some variables can be passed to the Makefile via `make <recipe> VARNAME=value ...`. Assigning these variables on the command line allows the user to change where Make will look for various paths.

- If the `VERBOSE` variable is specified, `abinit` experiment outputs will be copied to stdout
- `ABINIT_DIR_PATH` indicates the top-level folder where Abinit is installed. Default is `~/abinit`
- `CARBON_PSEUDO`, `NITROGEN_PSEUDO`, and `BORON_PSUEDO` indicate the files to give Abinit for atom pseudopotentials. Only used to build `.files` files. Defaults are specified in the [Makefile](Makefile)
- `DEFAULT_TOOLS_PATH` indicates where to find some of the python scripts that automate simulations. Default is `~/bin/abinit_parse_tools`
- `PATH_TO_EIG_PARSER` indicates where to find `parse_band_eigenvalues.py`. Default is `DEFAULT_TOOLS_PATH/parse_band_eigenvalues.py`
- `PATH_TO_DEN_PARSER` indicates where to find `spacedToCSV.jar`. Default is `DEFAULT_TOOLS_PATH/spacedToCSV.jar`
- `PATH_TO_EIG_GRAPHER` indicates where to find `graph_band_eigenvalues.py`. Default is `DEFAULT_TOOLS_PATH/graph_band_eigenvalues.py`
- `PATH_TO_ABINIT_INPUT_FILE_GENERATOR` indicates where to find `generate_abinit_input_file_from_json.py`. Default is `DEFAULT_TOOLS_PATH/generate_abinit_input_file_from_json.py`

## To-do
- Automatically extract energy of formation from Abinit output (very hard)
- Automatically generate doping experiments of varying densities
- Calculate state density